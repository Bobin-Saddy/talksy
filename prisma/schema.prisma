// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

// Note that some adapters may set a maximum length for the String type by default, please ensure your strings are long
// enough when changing adapters.
// See https://www.prisma.io/docs/orm/reference/prisma-schema-reference#string for more information
datasource db {
  provider = "sqlite"
  url      = "file:dev.sqlite"
}

model Session {
  id            String    @id
  shop          String
  state         String
  isOnline      Boolean   @default(false)
  scope         String?
  expires       DateTime?
  accessToken   String
  userId        BigInt?
  firstName     String?
  lastName      String?
  email         String?
  accountOwner  Boolean   @default(false)
  locale        String?
  collaborator  Boolean?  @default(false)
  emailVerified Boolean?  @default(false)
  refreshToken        String?
  refreshTokenExpires DateTime?
}


model ChatSession {
  id        String        @id @default(cuid())
  shop      String
  sessionId String        @unique
  firstName String?
  lastName  String?
  email     String?
  messages  ChatMessage[]
  createdAt DateTime      @default(now())
}

model ChatMessage {
  id            Int         @id @default(autoincrement())
  chatSessionId String
  session       ChatSession @relation(fields: [chatSessionId], references: [sessionId])
  message       String
  sender        String      // "user" or "admin"
  fileUrl       String?     // URL to the uploaded file
  fileType      String?     // e.g., "image/png", "application/pdf"
  createdAt     DateTime    @default(now())
}

model ChatSettings {
  id                    String   @id @default(uuid())
  shop                  String   @unique
  primaryColor          String   @default("#4F46E5")
  headerBgColor         String   @default("#111827")
  heroBgColor           String   @default("#EEF2FF")
  headerTextColor       String   @default("#FFFFFF")
  heroTextColor         String   @default("#111827")
  cardTitleColor        String   @default("#384959") // New
  cardSubtitleColor     String   @default("#64748b") // New
  onboardingTextColor   String   @default("#384959") // New
  welcomeImg            String   @default("https://ui-avatars.com/api/?name=Support&background=4F46E5&color=fff")
  headerTitle           String   @default("Customer Care")
  headerSubtitle        String   @default("Online & Ready")
  welcomeText           String   @default("How can we help?")
  welcomeSubtext        String   @default("Our team typically responds in under 5 minutes.")
  replyTimeText         String   @default("Replies instantly")
  fontFamily          String @default("-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif")
  baseFontSize        String @default("15px")
  // THIS WAS MISSING
  startConversationText String   @default("Send us a message") 
  
  launcherIcon          String   @default("bubble")
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
}